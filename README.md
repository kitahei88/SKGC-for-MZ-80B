# SKGC for SHARP MZ-80B
**Super Kolour Graphic Card kit for MZ-80B**
**Make your MZ-80B to MZ-2000+GVRAM!**
**No more need to plant bombs at Sharp corporation!**


### これはなんですか？ ###

往年の名機であるSHARPのMZ-80BをMZ-2000+GVRAM（MZ-2200相当）にするキットです。
MZ-80BとMZ-2000は多少の差があるのみで殆ど同じような設計です。
その差分を埋め、更には現代のICを使用することでMZ-2000＋GVRAM（3プレーン）という状態まで内蔵する形で設計しました。

作成には多くのパーツ、それぞれのICをへの書き込み用ツールが必要なため、パーツ実装のみならず、設計するためのツールを揃えるだけでも結構ハードルは高いです。
作成方法の解説は行いません。
（作成に伴った不具合への対応が困難なため）
回路図、ソース、それぞれのICへの書き込み方法など不明な場合はブログにて完成品を頒布していますので検討ください。

ブログのリンク

ライセンスと一般的注意事項

これらのデバイスおよびソフトウェア群はkitahei88, Takuya Fukudaにより作成された同人ハードウェア、ソフトウェアであり、使用、作成に関しては以下の一般的な注意事項に了承を得たものとします。
またマニュアルに記載されている内容は開発段階のものを含み、実際の動作などは改変により異なることがあります。
ライセンスは三条項BSDライセンスとします。詳細はLICENSEを参考ください。

以下、同人ハードウェアとしての一般的な使用前同意事項について記載します。

・ハードウェアの回路図、ソフトウェア群とも無償公開しますが、同時に無保証です。
使用により発生した損害（パソコンやディスク、ドライブが壊れた、データが破壊されたなど）に関しては一切責任を負わないものとします。
・サポートは最低限であり、修正が必要なバグがある可能性があります。
将来的に重大なバグなどが見つかる可能性があります。それらに対しての情報公開は行いますが、個別環境へのサポートは各自で行っていただく必要があります。
・使用、作成には「ある程度の知識、技術」が必要です。
回路図、ソースなどは公開していますが、作成する過程での一般的質問にはお答えしません。
上記したように完成品の頒布を行いますが、将来的に欠陥が認められた場合や改良が必要な場合が発生しても、修正情報を提供しますが個別にこちらで修正は行いません。自ら修正することが必要になります。
・異常な動作（発熱など）に注意を払い、電源管理など十分に行って下さい。
頒布する基板もパターンなどはむき出しです。自ら作成された場合などもパターンのショートなどで、発熱や発火の危険があります。これらによる何らかの損害が発生しても、責任を負わないものとします。十分に注意されて使用してください。

謝辞
AVRソフトウェア開発
AVR日本語情報サイト　えーう゛ぃあーる どっと　じぇーぴー
http://www.avr.jp/
日本語翻訳されたデータシートを参考にしました

動作環境
動作するMZ-80Bが必要です。
CMTやディスプレイはMZ_80B本体のものを使用します。
それらを修理やメンテナンスして、外部からCMTのエミュレーションを行うような実装にしていたり、ディスプレイを外部の液晶などへ表示するようにしていた場合の動作は保証外です。
MZ-80Bの動作を変更したり、改善したりするものではありません。
（例:MZ-80B用のGRAMの機能は無いため、MZ-80BのGRAMは別で取り付ける必要がある）
（将来的にCMTの代替ハードを取り付けられるように設計してありますが、現在は未実装です）
またMZ-2000（MZ-2200）のアプリケーションやソフトウェアは別途ご自身で用意が必要です。

取り付け方法
頒布したセットの取り付け方法を記載します。

まずMZ-80B本体の電源を確実に切り、電源ケーブルを外してください。
次に背面二箇所のネジを外し、CMTとモニター部分を上方へ押し上げ、本体をあけます。
CMTとモニター部分のカバーを5箇所のネジを外して開けます。
この際、モニター周囲は高圧が掛かっている可能性が高く、注意してください。最悪、指に穴が空きます。
写真にあるCMT制御基板のコネクターを外します。これはテープカウンターの動作信号が入ってくるところで、これでテープが回転しているかを入力しています。
ここにセットのケーブルをつけて取り込みます。
ケーブルはCMT基板のすぐ下にある、電源からのコードが通じている穴を通して、メインのマザーボード側へ誘導します。
この段階でCMTとモニター部分のカバーを元通り取り付けます。ネジで止めても問題ありません。

次にマザーボード側の取り付けを行います。
拡張I/OボードのMZ-8BKが取り付けられている場合、これを外さないとマザーボードが取り外せません。
まず、拡張I/Oボード背面のパネルを取り外します。
次に拡張I/Oボード用の電源を引き抜き、マザーボードと固定されているネジを取り外して引き抜きます。

マザーボードを取り外します。
マザーボードから伸びている、電源コード、CMT、キーボード、CMTコントロールボタン、リセット、ディスプレイ信号などのケーブルをすべて取り外します。
取り外しには力が必要だったり、爪で固定されているなどしているので、上手く外してください。
次にマザーボードと背面のパネルを固定してる2箇所のネジを取り外します。
そうすることで、マザーボードを背面にスライドさせることで取り外すことができます。

マザーボードには以下の4枚のカードを取り付けます。

IC43 G#3にはこの基板を取り付けます。
まず該当のICを取り外してください。このとき、ピン曲がりや折れに注意してください。
基板を写真の向きで取り付け、ICをソケットにはめ込みます。
このパーツ部分はMZ-80Bのキーボードの直下になり、不用意に高さがあるとキーボードの基板に干渉します。
その場合、ショートしたりするため、MZ-80Bが起動しない、キー入力ができないなどの不具合が出ることがあります。
しっかりはめ込んで、もし必要であればICのピン部分をマスキングしてください。（しっかりはめ込めば不要な高さとなるように設計しています）
このときも基板を割らないように、ピンを折らないように注意してください。
コネクターには３芯のケーブルを取り付けて、拡張ボード側へ誘導します。

IC2　G#1も同様です。
ICを取り外した後、基板を取り付け、ICを基板上のソケットにはめ込み、5芯のケーブルを取り付けてください。

CN13はGRAMを取り付ける10ピンのところです。
基板を取り付けて8芯のケーブルを取り付けてください。
写真の向きに取り付けます。
MZ-80BのGRAMを取り付けていた場合は、この基板上にあるコネクターにもともとの取り付け向きと同じように取り付けてください
（これはマザーボードなどをもとに戻した後に行います）

最後はIC23　8255です。
これも同じようにピン曲がりなどに気をつけてICを取り外します。
周囲のパーツの関係でこの基板のピンは長く作成しています。
曲がったり折れやすいので注意してはめ込んでください。
同様に8255も基板のソケットにはめ込みます。
こちらには3本のケーブルを挿入します。
4芯ケーブルは良いとして、2ピンのケーブルが2箇所あります。
中央の2ピンのコネクターはKINHを出力しています。そのためこのCMTコントロールボタンへ向かうケーブルに割り込ませる形のケーブルを装着します。
そしてもう一方の端の2ピンのコネクターには、CMTカウンターの信号を入力しますので、先程CMT基板に取り付けたケーブルをこちらへ誘導して装着します。
この2芯ケーブル2本はマザーを戻してからのほうが良いと思われます。

以上の4枚の基板を装着したら、マザーボードをスライドさせながらもとの位置へ戻し、2箇所のネジで止めます。
この状態で、先程取り外したケーブル類をもとに戻していきます。
奥から戻したほうが楽です。
そして、先程取り付けた8255の2芯2箇所のケーブルを取り付けます。
KINHのケーブルはCMTコントロールケーブルへ割り込ませる形で装着します。
最後にマザーボードの電源ケーブルを取り付けたか、確認してください。
マザーボードへの取り付けは完了です。

次に拡張I/Oボードの取り付けを行います。
もし拡張I/Oボードを持っていない場合はスキップしてください。

先程と逆に、拡張I/Oボードを取り付け、マザーボードとの間で2箇所のネジ止めを行います。
電源ケーブルをマザーボードへ取り付けます。
後ろのパネルはカードを取り付けるまで閉じないでください。
GRAMのカードを取り付けます。
マザーボードから複数のケーブルを装着する必要があるので、一番上のどちらかに装着してください。
背面から向かって左側がよいと思います。
こちらを装着したら、それぞれのケーブルをそれぞれのソケットへ装着します。
MZ-80BのGRAMがある場合はこれを取り付けてください。
ここまで行ったら、パネルを閉じてOKです。

CMT、ディスプレイを下へ戻し、ネジ止めしたら終了です。

拡張I/Oボードを所有していない場合、基板はフリーな状態となりますが使用可能です。
50ピンのストレートケーブル（古いSCSIのケーブルなど）で拡張I/Oボードの取り付けするコネクターからGRAMへそのままケーブルを取り付けます。
問題は電源ですが、外部で+5V電源を供給することで使用できるようにしています。
内部の電源をもらっても良いのですが、拡張I/Oボードへの電源のコネクターが入手できません。
そのほかのマザーからの信号線は同様に取り付けます。
基板がむき出しなのでショートしないようにしてください。

使用方法
まずMZ-80Bモードが動作するか確認してください。
GRAMにあるスイッチをMZ-80B側にして電源を投入します。
CMTが開くとか、CMTを読みに行く、BASICを読み込んだ後に巻き戻す、何かソフトウェアを読み込んで動作を確認するなどしてください。

次にMZ-2000のモードをチェックします。
電源を切った後にスイッチをMZ-2000側に切り換えます。
画面はグリーンモニターにも表示されますが、外部にminiDsub15ピンで接続するとカラーで表示されます。
同期信号はもともとのMZ-2000と同様に15KHzが出力されるようにしていますので、15KHzでRGB信号が入力可能なLCDを使用してください。
例：
HsyncとVsyncはそれぞれ出力されています、Csyncではありません。

この状態で電源を投入すると、外部モニターには白字で表示されると思います。
MZ-2000のBASICやソフトなどを読み込んでチェックしてみてください。
上手く画面表示、動作するのであれば完成です。
お疲れ様でした。

FAQ
なんでKolour？

8255の基板にある12ピンのコネクターはなんですか？

GRAMにある後ろのジャンパと2ピンのコネクターはなんですか？



改版履歴
