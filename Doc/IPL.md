# MZ-80BとMZ-2000とのIPLの違い、IPL選択用のBOOT ROMの作成について

MZ-80B、MZ-2000ともいわゆるクリーンコンピュータであり、起動時にIPL動作を行った後はオールRAMモードで動作します。
IPL中はCMT、FD、ExtROMの何れかからプログラムを読み込んで0x8000から格納し、その後オールRAMモードに実行を移すと、0x8000~0xFFFFまでが0x0000〜0x7FFFまでにアドレス変換され0x0000から実行されます。

オールRAMモードまでの動作で異なる点として、画面、GRAMの消去があり、キャラクターグラフィックの範囲以外に、MZ-80BはMZ-80BのGRAM1および2の内容を消去するように設定されており、MZ-2000はGRAMのRGB3プレーンをすべて消去するように動作しています。

当初、このSKGCプロジェクトはMZ-80BのIPL動作で起動後、MZ-2000のモードに変更して動作するように設計していましたが、上記動作でGRAMなどがクリアされれていることを前提に動作するソフトの場合、画面にノイズもしくはリセット前のデータが残ってしまいます。
（具体的にはハイドライドなど）

そのため、MZ-80BとMZ-2000のIPLを切り換えるためのボード、設定を追加しました。
これを使用するためには、当然ですがMZ-2000のIPLのデータが必要であり、実機MZ-2000を所有し、そこからIPLを読み込むかMZ-2000のMONITORマニュアルなどにあるIPLを自分で入力するなどが必要です。

MZ-80BのBOOT ROMは2716などですので、2732のEPROMに、0x0000〜0x7FFFまではMZ-2000のIPL、0x8000〜0xFFFFまではMZ-80BのIPLとしたバイナリファイルを書き込んで使用します。

GVRAM上にあるPL2と書かれたジャンパをショートすると、起動時からMZ-80BとMZ-2000のモード出力にスイッチの状態がそのまま出力されるようになっていますので、これをショートの状態でBOOT ROMにこのボードとIPLを書き込んだEPROMとして変更することで、MZ-2000モード時にIPL起動時からMZ-2000のIPLとして動作します。
